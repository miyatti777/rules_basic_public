---
description: 
globs: 
alwaysApply: true
---
# ========== æœ€çµ‚æ›´æ–°: 2025-04-23 11:37 (è‡ªå‹•æ›´æ–°: Discoveryãƒ•ã‚§ãƒ¼ã‚ºè¿½åŠ )==================
# ========== æœ€çµ‚æ›´æ–°: 2025-04-27 15:30 (è‡ªå‹•æ›´æ–°: æ±äº¬ã‚¢ã‚»ãƒƒãƒˆã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œå¯¾å¿œ)==================
# ========== æœ€çµ‚æ›´æ–°: 2025-05-01 12:00 (è‡ªå‹•æ›´æ–°: æ±äº¬ã‚¢ã‚»ãƒƒãƒˆã‚¤ãƒ³ã‚µã‚¤ãƒˆåˆ†ææ©Ÿèƒ½è¿½åŠ )==================
# ========== æœ€çµ‚æ›´æ–°: 2025-05-03 16:45 (è‡ªå‹•æ›´æ–°: Researchãƒ•ã‚§ãƒ¼ã‚ºè¿½åŠ )==================
# 00_master_rules.mdc
# ========== æœ€çµ‚æ›´æ–°: 2025-04-23 14:30 (è‡ªå‹•æ›´æ–°: ä¸å‹•ç”£ç‰¹åŒ–ãƒ«ãƒ¼ãƒ«è¿½åŠ )==================
# CursorãŒæœ€åˆã«èª­ã¿è¾¼ã‚€ã€Œãƒã‚¹ã‚¿ãƒ¼ãƒ«ãƒ¼ãƒ«ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™ã€‚
# - PMBOKé–¢é€£ã®ä¸»è¦ãƒˆãƒªã‚¬ãƒ¼ã‚’ä¸€å…ƒç®¡ç†ã—ã€æƒ…å ±åé›† â†’ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ ã®æµã‚Œã‚’å®šç¾©ã—ã¾ã™ã€‚
# - å®Ÿéš›ã®è³ªå•ãƒªã‚¹ãƒˆã‚„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¯ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆpmbok_initiating.mdcç­‰ï¼‰ã«è¨˜è¿°ã—ã€
#   ã“ã“ã§ã¯ã€Œå‘¼ã³å‡ºã—ã®æµã‚Œã€ã ã‘ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚
# - "steps" ã®ä¸­ã§å‚ç…§ã—ã¦ã„ã‚‹ "pmbok_initiating.mdc => charter_questions" ã¯ã€
#   pmbok_initiating.mdc ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«å®šç¾©ã•ã‚Œã‚‹ "charter_questions" ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™ã¨ã„ã†æƒ³å®šã§ã™ã€‚
# - å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å¿…è¦ã«å¿œã˜ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ãƒˆãƒªã‚¬ãƒ¼ã‚’æ‹¡å¼µãƒ»èª¿æ•´ã—ã¦ãã ã•ã„ã€‚

# ----------------
 
path_reference: "basic/pmbok_paths.mdc"

master_triggers:

  #--------------------------------------------
  # 0. æ±ç”¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç”Ÿæˆï¼ˆFlowç´ æè‡ªå‹•é›†ç´„ï¼‰
  #--------------------------------------------
  - trigger: "(ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ†²ç« |ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼åˆ†æ|WBSä½œæˆ|ãƒªã‚¹ã‚¯è¨ˆç”»)"
    priority: high
    mode: "exclusive"
    steps:
      - name: collect_flow_materials
        action: search_flow_files
        query:
          doc_targets: "{{matched_trigger}}"
          importance_gte: 3
          lookback_days: 30
        store_as: draft_pool
      - name: auto_prefill
        action: prefill_question_answers
        target_questions: "pmbok_*.mdc => *_questions"
        source: "{{draft_pool}}"
      - name: ask_missing
        action: ask_unfilled_questions
        message: "è­°äº‹éŒ²ãªã©ã‹ã‚‰æ‹¾ãˆãªã‹ã£ãŸé …ç›®ã ã‘å›ç­”ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: confirm
        action: confirm
        message: "é›†ç´„ãƒ‡ãƒ¼ã‚¿ï¼‹è¿½åŠ å›ç­”ã§ {{matched_trigger}} ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œã‚Šã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - name: create_draft
        action: create_markdown_file
        path: "{{patterns.flow_date}}/draft_{{matched_trigger}}.md"
        template_reference: "pmbok_*.mdc => *_template"
      - name: notify
        action: notify
        message: |
          ğŸ‰ Flow ã«ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚è¶³ã‚Šãªã„ã¨ã“ã‚ãŒã‚ã‚Œã°è¿½è¨˜ã—ã¦
          ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

  #--------------------------------------------
  # 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ†²ç« ä½œæˆ
  #--------------------------------------------
  - trigger: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ†²ç« |ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒ£ãƒ¼ã‚¿ãƒ¼"
    priority: high
    mode: "exclusive"
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_initiating.mdc => charter_questions"
        message: "ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ†²ç« ã€‘ã®ä½œæˆã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚ã™ã¹ã¦å›ç­”ãŒçµ‚ã‚ã‚‹ã¾ã§ãƒ•ã‚¡ã‚¤ãƒ«ã¯ä½œæˆã—ã¾ã›ã‚“ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"  # å…¨è³ªå•ãŒå›ç­”ã•ã‚Œã‚‹ or TBDæŒ‡å®šã§å®Œäº†
        message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆã‚’è¡Œã„ã¾ã›ã‚“ã€‚"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "åé›†ã—ãŸæƒ…å ±ã§ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ†²ç« ã€ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿï¼ˆã¯ã„/ã„ã„ãˆï¼‰"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_charter}}"
        template_reference: "basic/pmbok_initiating.mdc => charter_template"
        message: "ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ: {{patterns.draft_charter}}\nå¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ãƒ»è¿½è¨˜ã—ãŸå¾Œã€Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¸ç¢ºå®šåæ˜ ã§ãã¾ã™ã€‚"

  #--------------------------------------------
  # 2. ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼åˆ†æ
  #--------------------------------------------
  - trigger: "ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼åˆ†æ|ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ãƒãƒƒãƒ—"
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_initiating.mdc => stakeholder_questions"
        message: "ã€ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼åˆ†æã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
        message: "å›ç­”ãŒå®Œäº†ã—ãŸã‚‰ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ã‚’ç¢ºèªã—ã¾ã™ã€‚"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "åé›†ã—ãŸæƒ…å ±ã§ã€Œã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼åˆ†æè³‡æ–™ã€ã‚’ãƒ‰ãƒ©ãƒ•ãƒˆä½œæˆã—ã¦ã‚ˆã„ã§ã™ã‹ï¼Ÿï¼ˆã¯ã„/ã„ã„ãˆï¼‰"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_stakeholder}}"
        template_reference: "basic/pmbok_initiating.mdc => stakeholder_template"
        message: "draft_stakeholder_analysis.md ã‚’ä½œæˆã—ã¾ã—ãŸã€‚{{patterns.flow_date}} ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã‚ã‚Šã¾ã™ã€‚"

  #--------------------------------------------
  # 3. ãƒªã‚¹ã‚¯åˆ†æ / ãƒªã‚¹ã‚¯è¨ˆç”»
  #--------------------------------------------
  - trigger: "ãƒªã‚¹ã‚¯åˆ†æ|ãƒªã‚¹ã‚¯è¨ˆç”»"
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_planning.mdc => risk_questions"
        message: "ã€ãƒªã‚¹ã‚¯åˆ†æã€‘ã®ãŸã‚ã®åˆæœŸæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚å›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "ãƒªã‚¹ã‚¯è¨ˆç”»ã‚’ãƒ‰ãƒ©ãƒ•ãƒˆåŒ–ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_risk_plan}}"
        template_reference: "basic/pmbok_planning.mdc => risk_plan_template"
        message: "{{patterns.draft_risk_plan}} ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ã”ç¢ºèªãã ã•ã„ã€‚"

  #--------------------------------------------
  # 4. WBSä½œæˆ
  #--------------------------------------------
  - trigger: "WBSä½œæˆ|ä½œæ¥­åˆ†è§£æ§‹é€ "
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_planning.mdc => wbs_questions"
        message: "WBSã‚’ä½œæˆã—ã¾ã™ã€‚å¿…è¦äº‹é …ã‚’ãƒ’ã‚¢ãƒªãƒ³ã‚°ã—ã¾ã™ã®ã§ã€å›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "WBSãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚ˆã‚ã—ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_wbs}}"
        template_reference: "basic/pmbok_planning.mdc => wbs_template"
        message: "{{patterns.draft_wbs}} ã‚’å‡ºåŠ›ã—ã¾ã—ãŸã€‚è©³ç´°ã‚’è¿½è¨˜ã—ãŸã‚‰Stockã¸ç¢ºå®šã—ã¦ãã ã•ã„ã€‚"

  #--------------------------------------------
  # 4-1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚³ãƒ¼ãƒ—è¨˜è¿°æ›¸
  #--------------------------------------------
  - trigger: "(ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚³ãƒ¼ãƒ—è¨˜è¿°æ›¸|Project Scope Statement)"
    steps:
      - name: "start_info_collection"
        action: "call basic/03_pmbok_planning.mdc => project_scope_questions"
        message: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚³ãƒ¼ãƒ—è¨˜è¿°æ›¸ã‚’ä½œæˆã—ã¾ã™ã€‚å¿…è¦äº‹é …ã‚’ãƒ’ã‚¢ãƒªãƒ³ã‚°ã—ã¾ã™ã®ã§ã€å›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚³ãƒ¼ãƒ—è¨˜è¿°æ›¸ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚ˆã‚ã—ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_project_scope}}"
        template_reference: "basic/03_pmbok_planning.mdc => project_scope_template"
        message: "{{patterns.draft_project_scope}} ã‚’å‡ºåŠ›ã—ã¾ã—ãŸã€‚è©³ç´°ã‚’è¿½è¨˜ã—ãŸã‚‰Stockã¸ç¢ºå®šã—ã¦ãã ã•ã„ã€‚"

  #--------------------------------------------
  # 4-2. ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè¦æ±‚ä»•æ§˜æ›¸ï¼ˆPRDï¼‰
  #--------------------------------------------
  - trigger: "(ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè¦æ±‚ä»•æ§˜æ›¸|PRD|Product Requirements Document)"
    steps:
      - name: "start_info_collection"
        action: "call basic/03_pmbok_planning.mdc => prd_questions"
        message: "ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè¦æ±‚ä»•æ§˜æ›¸ï¼ˆPRDï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚å¿…è¦äº‹é …ã‚’ãƒ’ã‚¢ãƒªãƒ³ã‚°ã—ã¾ã™ã®ã§ã€å›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆè¦æ±‚ä»•æ§˜æ›¸ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚ˆã‚ã—ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_prd}}"
        template_reference: "basic/03_pmbok_planning.mdc => prd_template"
        message: "{{patterns.draft_prd}} ã‚’å‡ºåŠ›ã—ã¾ã—ãŸã€‚è©³ç´°ã‚’è¿½è¨˜ã—ãŸã‚‰Stockã¸ç¢ºå®šã—ã¦ãã ã•ã„ã€‚"

  #--------------------------------------------
  # 5. ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚´ãƒ¼ãƒ«ä½œæˆ
  #--------------------------------------------
  - trigger: "ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚´ãƒ¼ãƒ«|Sprint Goal"
    priority: high
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_executing.mdc => sprint_goal_questions"
        message: "ã€ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚´ãƒ¼ãƒ«ã€‘ä½œæˆã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
        message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
      - name: "confirm_document_creation" 
        action: "confirm"
        message: "å…¥åŠ›å†…å®¹ã§ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚´ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.flow_private_date}}/draft_sprint_goal_{{sprint_number}}.md"
        template_reference: "basic/pmbok_executing.mdc => sprint_goal_template"
        message: "ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚´ãƒ¼ãƒ«ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚"
      - name: notify
        action: notify
        message: |
          ã‚¹ãƒ—ãƒªãƒ³ãƒˆã‚´ãƒ¼ãƒ«ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ Flow ã«ç”Ÿæˆã—ã¾ã—ãŸã€‚ä¿®æ­£å¾Œã€
          ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨ Stock/projects/{{project_id}}/documents/4_executing/sprint_goals/ ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

  #--------------------------------------------
  # 6. ä¼šè­°è­°äº‹éŒ²
  #--------------------------------------------
  - trigger: "è­°äº‹éŒ²|ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒãƒ¼ãƒˆ"
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_executing.mdc => meeting_minutes_questions"
        message: "ä¼šè­°è­°äº‹éŒ²ã‚’ä½œæˆã—ã¾ã™ã€‚ä¼šè­°ã®åŸºæœ¬æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "è­°äº‹éŒ²ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚ˆã„ã§ã™ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "{{patterns.draft_minutes}}"
        template_reference: "basic/pmbok_executing.mdc => meeting_minutes_template"
        message: "{{patterns.draft_minutes}} ãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚"

  #--------------------------------------------
  # 7. å¤‰æ›´è¦æ±‚
  #--------------------------------------------
  - trigger: "å¤‰æ›´è¦æ±‚|ãƒã‚§ãƒ³ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆ"
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_monitoring.mdc => change_request_questions"
        message: "å¤‰æ›´è¦æ±‚ã‚’ä½œæˆã—ã¾ã™ã€‚å¿…è¦æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "å¤‰æ›´è¦æ±‚æ›¸ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "Flow/Private/{{today}}/draft_change_request.md"
        template_reference: "basic/pmbok_monitoring.mdc => change_request_template"
        message: "draft_change_request.md ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾Œã«æ‰¿èªãƒ•ãƒ­ãƒ¼ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚"

  #--------------------------------------------
  # 8. æ•™è¨“è¨˜éŒ² (Lessons Learned)
  #--------------------------------------------
  - trigger: "æ•™è¨“è¨˜éŒ²|ãƒ¬ãƒƒã‚¹ãƒ³ãƒ©ãƒ¼ãƒ‹ãƒ‰|ãƒ¬ãƒƒã‚¹ãƒ³ãšã‚‰ãƒ¼ã‚“ã©"
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_closing.mdc => lessons_learned_questions"
        message: "æ•™è¨“è¨˜éŒ²ï¼ˆLessons Learnedï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚ã„ãã¤ã‹è³ªå•ã‚’è¡Œã„ã¾ã™ã®ã§ã€å›ç­”ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "æ•™è¨“è¨˜éŒ²ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - name: "create_draft"
        action: "create_markdown_file"
        path: "Flow/Private/{{today}}/draft_lessons_learned.md"
        template_reference: "basic/pmbok_closing.mdc => lessons_learned_template"
        message: "draft_lessons_learned.md ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Œäº†å¾Œã®æŒ¯ã‚Šè¿”ã‚Šã«ãŠä½¿ã„ãã ã•ã„ã€‚"

#--------------------------------------------
# 9. ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒƒã‚¯ãƒ­ã‚°åˆæœŸåŒ–
#--------------------------------------------

    ```yaml
    trigger: 
    pattern: "(ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒƒã‚¯ãƒ­ã‚°åˆæœŸåŒ–|backlogåˆæœŸåŒ–|ãƒãƒƒã‚¯ãƒ­ã‚°åˆæœŸåŒ–)(ã—ã¦|ãŠé¡˜ã„)"
    priority: 100
    ```

    ```yaml
    action:
    type: function
    function: backlog_initialization
    params:
        template_path: "{{patterns.backlog_init_template}}"
        wbs_path: "{{patterns.wbs_path}}"
    ```

    ```javascript
    function backlog_initialization(params) {
    console.log("ãƒãƒƒã‚¯ãƒ­ã‚°åˆæœŸåŒ–ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã—ã¾ã™");
    
    // Planning ãƒ•ã‚§ãƒ¼ã‚ºã®ãƒ«ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã™
    return {
        type: "call_rule",
        rule: "03_pmbok_planning.mdc",
        function: "backlog_init",
        params: {
        template_path: params.template_path,
        wbs_path: params.wbs_path
        }
    };
    }
    ```

  - trigger: "(ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒƒã‚¯ãƒ­ã‚°åˆæœŸåŒ–|backlogåˆæœŸåŒ–|ãƒãƒƒã‚¯ãƒ­ã‚°åˆæœŸåŒ–)(ã—ã¦|ãŠé¡˜ã„)"
    priority: high
    steps:
      - name: "start_info_collection"
        action: "call basic/pmbok_planning.mdc => backlog_questions"
        message: "ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒãƒƒã‚¯ãƒ­ã‚°ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚å¿…è¦æƒ…å ±ã‚’åé›†ã—ã¾ã™ã®ã§å›ç­”ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚"
      - name: "wait_user_responses"
        action: "wait_for_all_answers"
        message: "å¿…è¦ãªæƒ…å ±ã‚’ã™ã¹ã¦åé›†ã™ã‚‹ã¾ã§ãŠå¾…ã¡ãã ã•ã„ã€‚"
      - name: "confirm_document_creation"
        action: "confirm"
        message: "åé›†ã—ãŸæƒ…å ±ã§ãƒãƒƒã‚¯ãƒ­ã‚°YAMLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - name: "create_backlog_yaml"
        action: "create_file"
        path: "{{patterns.backlog_yaml}}"
        template_reference: "basic/pmbok_planning.mdc => backlog_yaml_template"
        message: "backlog.yamlã‚’ä½œæˆã—ã¾ã—ãŸã€‚"
      - name: "create_epics_yaml" 
        action: "create_file"
        path: "{{patterns.epics_yaml}}"
        template_reference: "basic/pmbok_planning.mdc => epics_yaml_template"
        message: "epics.yamlã‚’ä½œæˆã—ã¾ã—ãŸã€‚"
      - name: "validate_backlog_yaml"
        action: "execute_shell"
        command: "python {{patterns.backlog_validate_script}} {{patterns.backlog_yaml}}"
        message: "ãƒãƒƒã‚¯ãƒ­ã‚°YAMLã®æ¤œè¨¼ã‚’è¡Œã„ã¾ã™ã€‚"
      - name: "notify_completion"
        action: "notify"
        message: |
          ãƒãƒƒã‚¯ãƒ­ã‚°ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸã€‚backlog.yamlã¨epics.yamlãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚
          ã“ã‚Œã‚’åŸºã«ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã§ãã¾ã™ã€‚
          å†…å®¹ã‚’ç¢ºèªã€ä¿®æ­£ã—ãŸå¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockã¸åæ˜ ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# 10. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ
#--------------------------------------------
  - trigger: "(ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ|ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ç”Ÿæˆ|storyç”Ÿæˆ)(ã—ã¦|ãŠé¡˜ã„)"
    priority: high
    steps:
      - name: "run_yaml_to_stories_script"
        action: "execute_shell"
        command: "python /Users/daisukemiyata/{{root}}/scripts/yaml_to_stories.py {{patterns.backlog_yaml}} {{patterns.stories_dir}}"
        message: "backlog.yamlã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¾ã™ã€‚"
      - name: "notify_generation_complete"
        action: "notify"
        message: |
          ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚
          {{patterns.stories_dir}}ã«ç”Ÿæˆã•ã‚ŒãŸã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
          ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã§ Stock/backlog/stories ã¸ç§»å‹•ã§ãã¾ã™ã€‚



#--------------------------------------------
# 11. ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ä½œæˆ  â˜…NEW
#--------------------------------------------
  - trigger: "(ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ä½œæˆ|ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—|ãƒªãƒªãƒ¼ã‚¹è¨ˆç”»)"
    priority: high
    steps:
      # â‘  æ—¢å­˜è³‡æ–™ã‹ã‚‰è‡ªå‹•ä¸‹æ›¸ã
      - collect_flow_materials:
          query:
            doc_targets: "ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—|roadmap"
            lookback_days: 30
          store_as: roadmap_pool
      - prefill_question_answers:
          target_questions: "pmbok_planning.mdc => roadmap_questions"
          source: "{{roadmap_pool}}"
      # â‘¡ ä¸è¶³è³ªå•
      - ask_unfilled_questions:
          message: "ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã«å¿…è¦ãªè¿½åŠ æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
      # â‘¢ ç¢ºèª
      - confirm: "å…¥åŠ›å†…å®¹ã§ ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ— ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ Flow ã«ç”Ÿæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      # â‘£ ãƒ‰ãƒ©ãƒ•ãƒˆç”Ÿæˆ
      - create_markdown_file:
          path: "{{patterns.draft_roadmap}}"
          template_reference: "basic/pmbok_planning.mdc => roadmap_template"
      - notify: |
          {{patterns.draft_roadmap}} ã‚’ä½œæˆã—ã¾ã—ãŸã€‚å¿…è¦ã«å¿œã˜ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã§ Stock ã«ç§»å‹•ã—ã¾ã™ã€‚

#--------------------------------------------
# 12. Sprint Review è‡ªå‹•ç”Ÿæˆ (æ¯é€±é‡‘æ›œ 17:00 or æ‰‹å‹•)
#--------------------------------------------
  - trigger: "(ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ä½œæˆ|Sprint Review)"
    priority: high
    steps:
      # A) Flow å†…ã®æ—¥æ¬¡ã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•é›†ç´„
      - collect_flow_materials:
          query:
            glob: "{{patterns.daily_tasks_glob}}"
            lookback_days: 14
          store_as: daily_pool

      # B) å®Œäº†ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ï¼ã‚¤ãƒ³ãƒšãƒ‡ã‚£ãƒ¡ãƒ³ãƒˆæŠ½å‡º
      - transform:
          source: "{{daily_pool}}"
          script: |
            # å…¥åŠ›: list[str] (= æ—¥æ¬¡ã‚¿ã‚¹ã‚¯ md)
            import re, yaml, textwrap, json, itertools, pathlib
            done = set(); imped = []
            for path,txt in source:
                for line in txt.splitlines():
                    m = re.match(r"- \[x\] (US-[0-9]+)", line, re.I)
                    if m: done.add(m.group(1))
                    if "âš " in line or "impediment" in line.lower():
                        imped.append(line.lstrip("- "))

            print(json.dumps({
              "demo_items": "\n".join(f"- {d}" for d in sorted(done)),
              "impediments": "\n".join(f"- {i}" for i in imped)
            }))
          store_as: auto_data

      # C) è³ªå•ãƒ—ãƒªãƒ•ã‚£ãƒ«
      - prefill_question_answers:
          target_questions: "pmbok_executing.mdc => sprint_review_questions"
          source: "{{auto_data}}"

      # D) ä¸è¶³è³ªå•ãƒ’ã‚¢ãƒªãƒ³ã‚°
      - ask_unfilled_questions:
          message: "Sprint Review ã«ä¸è¶³ã—ã¦ã„ã‚‹æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"

      # E) ç¢ºèªã—ã¦ãƒ‰ãƒ©ãƒ•ãƒˆç”Ÿæˆ
      - confirm: "å…¥åŠ›ï¼‹è‡ªå‹•é›†ç´„ã§ Sprint Review ã‚’ Flow ã«ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
      - create_markdown_file:
          path: "{{patterns.draft_review}}"
          template_reference: "basic/pmbok_executing.mdc => sprint_review_template"
      - notify: |
          {{patterns.draft_review}} ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚
          ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã§ Stock/sprints/{{sprint_id}} ã¸ç§»å‹•ã—ã¾ã™ã€‚

#--------------------------------------------
# 13. ã‚¿ã‚¹ã‚¯ç®¡ç†
#--------------------------------------------
  - trigger: "(ä»Šæ—¥ã®ã‚¿ã‚¹ã‚¯|æ—¥æ¬¡ã‚¿ã‚¹ã‚¯ä½œæˆ|Daily tasks)"
    call_rule: "07_task_management.mdc => daily_tasks"
  - trigger: "(é€±æ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼|Weekly review)"
    call_rule: "07_task_management.mdc => weekly_review"
  - trigger: "(Sync|WBSã¨åŒæœŸ|ãƒªã‚¹ã‚¯ãƒ­ã‚°ã¨åŒæœŸ)"
    call_rule: "07_task_management.mdc => sync_with_artifacts"



#--------------------------------------------
# 14. Discovery ãƒ•ã‚§ãƒ¼ã‚º
#--------------------------------------------
- trigger: "(ãƒ‡ã‚£ã‚¹ã‚«ãƒãƒªãƒ¼|Discovery)"
priority: high
steps:
    - message: |
        Discoveryï¼ˆç™ºè¦‹ï¼‰ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ä»¥ä¸‹ã®æˆæœç‰©ã‚’ä½œæˆã§ãã¾ã™ï¼š
        - **Assumption Mapï¼ˆå‰ææ¡ä»¶ãƒãƒƒãƒ—ï¼‰**ï¼šã€Œä»®èª¬ãƒãƒƒãƒ—ã€ã¨å…¥åŠ›
        - **Personaï¼ˆãƒšãƒ«ã‚½ãƒŠï¼‰**ï¼šã€Œãƒšãƒ«ã‚½ãƒŠä½œæˆã€ã¨å…¥åŠ›
        - **Problem Statementï¼ˆèª²é¡Œå®šç¾©ï¼‰**ï¼šã€Œèª²é¡Œå®šç¾©ã€ã¨å…¥åŠ›
        - **User Journey Mapï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ãƒãƒƒãƒ—ï¼‰**ï¼šã€Œã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ãƒãƒƒãƒ—ã€ã¨å…¥åŠ›
        - **Solution Definitionï¼ˆã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©ï¼‰**ï¼šã€Œã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©ã€ã¨å…¥åŠ›
        - **Validation Planï¼ˆæ¤œè¨¼è¨ˆç”»ï¼‰**ï¼šã€Œæ¤œè¨¼è¨ˆç”»ã€ã¨å…¥åŠ›
        - **Hypothesis Backlogï¼ˆä»®èª¬ãƒãƒƒã‚¯ãƒ­ã‚°ï¼‰**ï¼šã€Œä»®èª¬ãƒãƒƒã‚¯ãƒ­ã‚°ã€ã¨å…¥åŠ›

#--------------------------------------------
# Discovery: Assumption Map
#--------------------------------------------
- trigger: "(ä»®èª¬ãƒãƒƒãƒ—|Assumption Map)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => assumption_questions
  - wait_for_all_answers
  - confirm: "Assumption Mapï¼ˆå‰ææ¡ä»¶ãƒãƒƒãƒ—ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.draft_assumption}}"
      template_reference: "02_pmbok_discovery.mdc => assumption_template"

#--------------------------------------------
# Discovery: Persona
#--------------------------------------------
- trigger: "(ãƒšãƒ«ã‚½ãƒŠä½œæˆ|Persona)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => persona_questions
  - wait_for_all_answers
  - confirm: "ãƒšãƒ«ã‚½ãƒŠã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.draft_persona}}"
      template_reference: "02_pmbok_discovery.mdc => persona_template"

#--------------------------------------------
# Discovery: Problem Statement
#--------------------------------------------
- trigger: "(èª²é¡Œå®šç¾©|Problem Statement)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => problem_questions
  - wait_for_all_answers
  - confirm: "èª²é¡Œå®šç¾©æ›¸ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.draft_problem}}"
      template_reference: "02_pmbok_discovery.mdc => problem_template"

#--------------------------------------------
# Discovery: User Journey Map
#--------------------------------------------
- trigger: "(ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ãƒãƒƒãƒ—|User Journey Map|ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ãƒãƒƒãƒ—)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => journey_map_questions
  - wait_for_all_answers
  - confirm: "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ãƒãƒƒãƒ—ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.flow_private_date}}/draft_user_journey_map.md"
      template_reference: "02_pmbok_discovery.mdc => journey_map_template"

#--------------------------------------------
# Discovery: Solution Definition
#--------------------------------------------
- trigger: "(ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©|Solution Definition)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => solution_definition_questions
  - wait_for_all_answers
  - confirm: "ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©æ›¸ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.flow_date}}/draft_solution_definition.md"
      template_reference: "02_pmbok_discovery.mdc => solution_definition_template"

#--------------------------------------------
# Discovery: Validation Plan
#--------------------------------------------
- trigger: "(æ¤œè¨¼è¨ˆç”»|ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³|Validation Plan)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => validation_plan_questions
  - wait_for_all_answers
  - confirm: "æ¤œè¨¼è¨ˆç”»ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.flow_private_date}}/draft_validation_plan.md"
      template_reference: "02_pmbok_discovery.mdc => validation_plan_template"

#--------------------------------------------
# Discovery: Hypothesis Backlog
#--------------------------------------------
- trigger: "(ä»®èª¬ãƒãƒƒã‚¯ãƒ­ã‚°|Hypothesis)"
priority: high
steps:
  - call basic/02_pmbok_discovery.mdc => hypothesis_questions
  - wait_for_all_answers
  - confirm: "ä»®èª¬ãƒãƒƒã‚¯ãƒ­ã‚°ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
  - create_markdown_file:
      path: "{{patterns.draft_hypothesis}}"
      template_reference: "02_pmbok_discovery.mdc => hypothesis_template"

#--------------------------------------------
# Flow Assist ãƒ•ã‚§ãƒ¼ã‚º
#--------------------------------------------
- trigger: "(ã‚¢ã‚¤ãƒ‡ã‚£ã‚¢ç™ºæ•£)"
  priority: high
  steps:
    - call basic/03_pmbok_flow_assist.mdc => flow_assist_questions
    - wait_for_all_answers
    - confirm: "Flow Assist ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - create_markdown_file:
        path: "{{patterns.flow_date}}/draft_flow_assist.md"
        template_reference: "03_pmbok_flow_assist.mdc => flow_assist_template"

#--------------------------------------------
# è£œè¶³: å…¨ä½“è¨­å®šã‚„å…±é€šãƒ¡ã‚¿æƒ…å ±ãªã©
#--------------------------------------------
settings:
  # ãƒ«ãƒ¼ãƒ«å…¨ä½“ã«é©ç”¨ã™ã‚‹å…±é€šè¨­å®šä¾‹
  # ä¾‹: (ã‚ãã¾ã§å‚è€ƒã€å®Ÿéš›ã®Cursorç’°å¢ƒã«åˆã‚ã›ã¦æ›¸ãæ›¿ãˆã¦ãã ã•ã„)
  date_format: "YYYY-MM-DD"
  language: "ja"
  default_actions:
    - "information_collection"
    - "confirm_creation"
    - "create_file_in_flow"
  error_handling:
    unrecognized_trigger: "ã™ã¿ã¾ã›ã‚“ã€ãã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«å¯¾å¿œã™ã‚‹ãƒ«ãƒ¼ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
    partial_answer: "ä¸€éƒ¨å›ç­”ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚TBDã§ã‚ˆã‘ã‚Œã°åŸ‹ã‚ã¾ã™ãŒã€ã©ã†ã—ã¾ã™ã‹ï¼Ÿ"

notes:
  - "ã“ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ«ãƒ¼ãƒ«ã§ä½¿ã‚ã‚Œã‚‹ pmbok_initiating.mdc, pmbok_planning.mdc ç­‰ã«å„ãƒ•ã‚§ãƒ¼ã‚ºã®è³ªå•ãƒªã‚¹ãƒˆãƒ»ãƒ†ãƒ³ãƒ—ãƒ¬ã‚’è¨˜è¼‰"
  - "flow_to_stock_rules.mdc ç­‰ã§ãƒ‰ãƒ©ãƒ•ãƒˆâ†’ç¢ºå®šåæ˜ ã®æ‰‹é †ã‚’å®šç¾©ã™ã‚‹"
  - "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€”ä¸­ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«/ä¿ç•™ã—ãŸå ´åˆã®å‡¦ç†ã‚’ã©ã†ã™ã‚‹ã‹ã€å¿…è¦ãªã‚‰ 'cancel' ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹"
  - "project_id ã‚„ today ãªã©ã®å¤‰æ•°ã¯å‘¼ã³å‡ºã—æ™‚ã«ã‚»ãƒƒãƒˆã•ã‚Œã€Cursor ãŒè‡ªå‹•çš„ã«è§£æ±ºã—ã¾ã™"
  - "ä½¿ç”¨ä¾‹ï¼šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID ã¯ AIPM-PMBOK ã®ã‚ˆã†ã«ã”æŒ‡å®šãã ã•ã„"

#--------------------------------------------
# 15. ä¸å‹•ç”£ç‰¹åŒ–ãƒ«ãƒ¼ãƒ«
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£|Real Estate)"
  priority: high
  steps:
    - message: |
        ä¸å‹•ç”£æ¥­ç•Œå‘ã‘Discoveryãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ä»¥ä¸‹ã®å°‚ç”¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™ï¼š
        - **ä¸å‹•ç”£å¸‚å ´èª¿æŸ»**ï¼šã€Œä¸å‹•ç”£å¸‚å ´èª¿æŸ»ã€ã¨å…¥åŠ›
        - **ä¸å‹•ç”£ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ**ï¼šã€Œä¸å‹•ç”£ãƒšãƒ«ã‚½ãƒŠã€ã¨å…¥åŠ›
        - **ä¸å‹•ç”£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª²é¡Œå®šç¾©**ï¼šã€Œä¸å‹•ç”£èª²é¡Œå®šç¾©ã€ã¨å…¥åŠ›
        - **ä¸å‹•ç”£ä»®èª¬æ¤œè¨¼è¨ˆç”»**ï¼šã€Œä¸å‹•ç”£æ¤œè¨¼è¨ˆç”»ã€ã¨å…¥åŠ›
        - **ä¸å‹•ç”£ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æ**ï¼šã€Œä¸å‹•ç”£ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æã€ã¨å…¥åŠ›
        
        æ±äº¬ã‚¢ã‚»ãƒƒãƒˆAIã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ã£ãŸåˆ†æã‚‚å¯èƒ½ã§ã™ï¼š
        - **æ±äº¬ã‚¢ã‚»ãƒƒãƒˆä¸å‹•ç”£ãƒ‡ãƒ¼ã‚¿åé›†**ï¼šã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆåé›†ã€ã¨å…¥åŠ›
        - **æ±äº¬ã‚¢ã‚»ãƒƒãƒˆä¸å‹•ç”£åˆ†æ**ï¼šã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆåˆ†æã€ã¨å…¥åŠ›
        - **æ±äº¬ã‚¢ã‚»ãƒƒãƒˆæ´å¯Ÿç”Ÿæˆ**ï¼šã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆæ´å¯Ÿã€ã¨å…¥åŠ›

#--------------------------------------------
# ä¸å‹•ç”£: å¸‚å ´èª¿æŸ»
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£å¸‚å ´èª¿æŸ»|Real Estate Market)"
  priority: high
  steps:
    - call basic/pmbok_discovery_real_estate.mdc => real_estate_market_questions
    - wait_for_all_answers
    - confirm: "ä¸å‹•ç”£å¸‚å ´èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - create_markdown_file:
        path: "{{patterns.flow_private_date}}/draft_real_estate_market.md"
        template_reference: "basic/pmbok_discovery_real_estate.mdc => real_estate_market_template"
    - notify: |
        ä¸å‹•ç”£å¸‚å ´èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{patterns.flow_private_date}}/draft_real_estate_market.md ã‚’ç¢ºèªã—ã€
        å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

#--------------------------------------------
# ä¸å‹•ç”£: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠ
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£ãƒšãƒ«ã‚½ãƒŠ|Real Estate Persona)"
  priority: high
  steps:
    - call basic/pmbok_discovery_real_estate.mdc => real_estate_persona_questions
    - wait_for_all_answers
    - confirm: "ä¸å‹•ç”£ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - create_markdown_file:
        path: "{{patterns.flow_private_date}}/draft_real_estate_persona.md"
        template_reference: "basic/pmbok_discovery_real_estate.mdc => real_estate_persona_template"
    - notify: |
        ä¸å‹•ç”£ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒšãƒ«ã‚½ãƒŠã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{patterns.flow_private_date}}/draft_real_estate_persona.md ã‚’ç¢ºèªã—ã€
        å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

#--------------------------------------------
# ä¸å‹•ç”£: èª²é¡Œå®šç¾©
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£èª²é¡Œå®šç¾©|Real Estate Problem)"
  priority: high
  steps:
    - call basic/pmbok_discovery_real_estate.mdc => real_estate_problem_questions
    - wait_for_all_answers
    - confirm: "ä¸å‹•ç”£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª²é¡Œå®šç¾©æ›¸ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - create_markdown_file:
        path: "{{patterns.flow_private_date}}/draft_real_estate_problem.md"
        template_reference: "basic/pmbok_discovery_real_estate.mdc => real_estate_problem_template"
    - notify: |
        ä¸å‹•ç”£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª²é¡Œå®šç¾©æ›¸ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{patterns.flow_private_date}}/draft_real_estate_problem.md ã‚’ç¢ºèªã—ã€
        å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

#--------------------------------------------
# ä¸å‹•ç”£: ä»®èª¬æ¤œè¨¼è¨ˆç”»
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£æ¤œè¨¼è¨ˆç”»|Real Estate Validation)"
  priority: high
  steps:
    - call basic/pmbok_discovery_real_estate.mdc => real_estate_validation_questions
    - wait_for_all_answers
    - confirm: "ä¸å‹•ç”£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»®èª¬æ¤œè¨¼è¨ˆç”»ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - create_markdown_file:
        path: "{{patterns.flow_private_date}}/draft_real_estate_validation.md"
        template_reference: "basic/pmbok_discovery_real_estate.mdc => real_estate_validation_template"
    - notify: |
        ä¸å‹•ç”£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä»®èª¬æ¤œè¨¼è¨ˆç”»ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{patterns.flow_private_date}}/draft_real_estate_validation.md ã‚’ç¢ºèªã—ã€
        å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

#--------------------------------------------
# ä¸å‹•ç”£: ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æ
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æ|Real Estate Location)"
  priority: high
  steps:
    - call basic/pmbok_discovery_real_estate.mdc => real_estate_location_questions
    - wait_for_all_answers
    - confirm: "ä¸å‹•ç”£ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - create_markdown_file:
        path: "{{patterns.flow_private_date}}/draft_real_estate_location.md"
        template_reference: "basic/pmbok_discovery_real_estate.mdc => real_estate_location_template"
    - notify: |
        ä¸å‹•ç”£ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{patterns.flow_private_date}}/draft_real_estate_location.md ã‚’ç¢ºèªã—ã€
        å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ãƒ‡ãƒ¼ã‚¿å‡¦ç†
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£ãƒ‡ãƒ¼ã‚¿å‡¦ç†|real estate data processing)"
  priority: high
  steps:
    - name: "ask_data_processing_info"
      action: "ask_questions"
      questions:
        - key: "input_dir"
          question: "å‡¦ç†ã™ã‚‹å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Flow/{{today}}/{{PJ}}/inputsï¼‰"
          default: "Flow/{{today}}/{{PJ}}/inputs"
          required: false
        - key: "output_dir"
          question: "å‡¦ç†çµæœã®å‡ºåŠ›å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Flow/{{today}}/{{PJ}}/outputsï¼‰"
          default: "Flow/{{today}}/{{PJ}}/outputs"
          required: false
        - key: "data_type"
          question: "å‡¦ç†ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„"
          options:
            - "propertyï¼ˆä¸å‹•ç”£æƒ…å ±ï¼‰"
          default: "property"
          required: true
      store_as: "processing_info"
    - name: "confirm_data_processing"
      action: "confirm"
      message: "ä»¥ä¸‹ã®è¨­å®šã§ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ\n\nå…¥åŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: {{processing_info.input_dir}}\nå‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª: {{processing_info.output_dir}}\nãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—: {{processing_info.data_type}}"
    - name: "process_each_file"
      action: "for_each"
      items: "{{input_files.stdout_lines}}"
      variable: "input_file"
      steps:
        - name: "execute_process_command"
          action: "execute_shell"
          command: "cd /Users/daisukemiyata/aipm_v3/Stock/programs/tokyo_asset/projects/tas_ai_system/dev/demo/mock_api_v2 && python tokyo-asset-cli.py collect-file process \"{{input_file}}\" --data-type {{processing_info.data_type | replace('ï¼ˆä¸å‹•ç”£æƒ…å ±ï¼‰', '') | trim}} --input-dir \"{{processing_info.input_dir}}\" --output-dir \"{{processing_info.output_dir}}\""
          message: "ãƒ•ã‚¡ã‚¤ãƒ« {{input_file}} ã‚’å‡¦ç†ä¸­..."
    - name: "notify_processing_complete"
      action: "notify"
      message: |
        ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚
        
        æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ï¼š
        1. ã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆåˆ†æã€ã¨å…¥åŠ›ã™ã‚‹ã¨å‡¦ç†ã—ãŸãƒ‡ãƒ¼ã‚¿ã®åˆ†æã‚’å®Ÿè¡Œã§ãã¾ã™
        2. ã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆæ´å¯Ÿã€ã¨å…¥åŠ›ã™ã‚‹ã¨åˆ†æçµæœã‹ã‚‰æ´å¯Ÿã‚’ç”Ÿæˆã§ãã¾ã™
        3. ã€Œä¸å‹•ç”£å¸‚å ´èª¿æŸ»ã€ã€Œä¸å‹•ç”£ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆ†æã€ãªã©ã§è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã§ãã¾ã™

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ãƒ‡ãƒ¼ã‚¿åé›†
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£ãƒ‡ãƒ¼ã‚¿åé›†|tokyo asset crawler)"
  priority: high
  steps:
    - name: "ask_crawler_info"
      action: "ask_questions"
      questions:
        - key: "search_type"
          question: "æ¤œç´¢ã‚¿ã‚¤ãƒ—ã‚’é¸æŠã—ã¦ãã ã•ã„"
          options:
            - "ã‚¨ãƒªã‚¢æƒ…å ±æ¤œç´¢"
            - "å¸‚å ´æƒ…å ±æ¤œç´¢"
            - "ä¸è¶³æƒ…å ±æ¤œç´¢"
            - "å°†æ¥äºˆæ¸¬æ¤œç´¢"
            - "é¡ä¼¼æ¤œç´¢"
            - "ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢"
          default: "ã‚¨ãƒªã‚¢æƒ…å ±æ¤œç´¢"
          required: true
        - key: "area"
          question: "å¯¾è±¡ã‚¨ãƒªã‚¢åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆä¾‹: æœ¬éƒ·ä¸‰ä¸ç›®ã€æ¸‹è°·åŒºï¼‰"
          required: true
        - key: "custom_query"
          question: "ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢ã®å ´åˆã€ä»»æ„ã‚¯ã‚¨ãƒªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: false
          condition: "search_type == 'ã‚«ã‚¹ã‚¿ãƒ æ¤œç´¢'"
        - key: "output_dir"
          question: "å‡ºåŠ›å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: crawler/resultsï¼‰"
          default: "{{patterns.flow_private_date}}/crawler"
          required: false
      store_as: "crawler_info"
    - name: "confirm_crawler_execution"
      action: "confirm"
      message: "ä»¥ä¸‹ã®è¨­å®šã§Webãƒ‡ãƒ¼ã‚¿åé›†ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ\n\næ¤œç´¢ã‚¿ã‚¤ãƒ—: {{crawler_info.search_type}}\nå¯¾è±¡ã‚¨ãƒªã‚¢: {{crawler_info.area}}{{crawler_info.custom_query ? '\nã‚«ã‚¹ã‚¿ãƒ ã‚¯ã‚¨ãƒª: ' + crawler_info.custom_query : ''}}\nå‡ºåŠ›å…ˆ: {{crawler_info.output_dir}}"
    - name: "execute_crawler_command"
      action: "execute_shell"
      command: "cd {{dirs.root}}/Stock/programs/tokyo_asset/projects/tas_ai_system/dev/demo/mock_api_v2 && python tokyo-asset-cli.py collect-crawler run --search-type \"{{crawler_info.search_type}}\" --area \"{{crawler_info.area}}\"{{crawler_info.custom_query ? ' --custom-query \"' + crawler_info.custom_query + '\"' : ''}} --output-dir \"{{crawler_info.output_dir}}\""
      message: "Webæ¤œç´¢ã‚’å®Ÿè¡Œä¸­..."
    - name: "notify_crawler_complete"
      action: "notify"
      message: |
        ãƒ‡ãƒ¼ã‚¿åé›†ãŒå®Œäº†ã—ã¾ã—ãŸã€‚
        
        æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ï¼š
        1. ã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆåˆ†æã€ã¨å…¥åŠ›ã™ã‚‹ã¨åé›†ã—ãŸãƒ‡ãƒ¼ã‚¿ã®åˆ†æã‚’å®Ÿè¡Œã§ãã¾ã™
        2. ã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆæ´å¯Ÿã€ã¨å…¥åŠ›ã™ã‚‹ã¨åé›†ã—ãŸãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ´å¯Ÿã‚’ç”Ÿæˆã§ãã¾ã™
        3. {{crawler_info.output_dir}} ã«ä¿å­˜ã•ã‚ŒãŸJSONãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã§ãã¾ã™

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ãƒ‡ãƒ¼ã‚¿åˆ†æ
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£ãƒ‡ãƒ¼ã‚¿åˆ†æ|real estate analytics)"
  priority: high
  steps:
    - name: "ask_analytics_info"
      action: "ask_questions"
      questions:
        - key: "input_file"
          question: "åˆ†æã™ã‚‹å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: true
        - key: "output_dir"
          question: "çµæœã®å‡ºåŠ›å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Flow/{{today}}ï¼‰"
          default: "{{patterns.flow_private_date}}/analytics"
          required: false
        - key: "generate_graphs"
          question: "ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆã—ã¾ã™ã‹ï¼Ÿ"
          options:
            - "true"
            - "false"
          default: "true"
          required: false
      store_as: "analytics_info"
    - name: "confirm_analytics_execution"
      action: "confirm"
      message: "ä»¥ä¸‹ã®è¨­å®šã§ä¸å‹•ç”£ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ\n\nå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«: {{analytics_info.input_file}}\nå‡ºåŠ›å…ˆ: {{analytics_info.output_dir}}\nã‚°ãƒ©ãƒ•ç”Ÿæˆ: {{analytics_info.generate_graphs}}"
    - name: "execute_analytics_command"
      action: "execute_shell"
      command: "cd {{dirs.root}}/Stock/programs/tokyo_asset/projects/tas_ai_system/dev/demo/mock_api_v2 && python tokyo-asset-cli.py analytics run --input-file \"{{analytics_info.input_file}}\" --output-dir \"{{analytics_info.output_dir}}\" --generate-graphs {{analytics_info.generate_graphs}}"
      message: "ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’å®Ÿè¡Œä¸­..."
    - name: "notify_analytics_complete"
      action: "notify"
      message: |
        ãƒ‡ãƒ¼ã‚¿åˆ†æãŒå®Œäº†ã—ã¾ã—ãŸã€‚
        
        æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»¥ä¸‹ã®ã¨ãŠã‚Šã§ã™ï¼š
        1. {{analytics_info.output_dir}} ã«ç”Ÿæˆã•ã‚ŒãŸåˆ†æã‚°ãƒ©ãƒ•ã¨çµæœã‚’ç¢ºèªã§ãã¾ã™
        2. ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨åˆ†æçµæœã‚’Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã§ãã¾ã™
        3. ã€Œæ±äº¬ã‚¢ã‚»ãƒƒãƒˆæ´å¯Ÿã€ã¨å…¥åŠ›ã™ã‚‹ã¨åˆ†æçµæœã‹ã‚‰æ´å¯Ÿã‚’ç”Ÿæˆã§ãã¾ã™

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ã‚¤ãƒ³ã‚µã‚¤ãƒˆåˆ†æ
#--------------------------------------------
- trigger: "(ä¸å‹•ç”£ã‚¤ãƒ³ã‚µã‚¤ãƒˆåˆ†æ|tokyo asset insight)"
  priority: high
  steps:
    - message: |
        æ±äº¬ã‚¢ã‚»ãƒƒãƒˆAIã‚·ã‚¹ãƒ†ãƒ ã§ã¯ä»¥ä¸‹ã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆåˆ†æãŒå¯èƒ½ã§ã™ï¼š
        
        - **ã‚¨ãƒªã‚¢åˆ†æ**ï¼šã€Œã‚¨ãƒªã‚¢åˆ†æã€ã¨å…¥åŠ›
        - **ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æ**ï¼šã€Œã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æã€ã¨å…¥åŠ›
        - **é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æ**ï¼šã€Œé¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æã€ã¨å…¥åŠ›
        - **ã‚«ã‚¹ã‚¿ãƒ åˆ†æ**ï¼šã€Œã‚«ã‚¹ã‚¿ãƒ åˆ†æã€ã¨å…¥åŠ›
        
        æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã™ã‚‹å ´åˆã¯ã€è³ªå•ã«ç­”ãˆã‚‹éš›ã«ã€Œæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ã€ã‚’é¸æŠã—ã¦ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ã‚¨ãƒªã‚¢åˆ†æ
#--------------------------------------------
- trigger: "(ã‚¨ãƒªã‚¢åˆ†æ|area analysis)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/insight_analysis.mdc => area_analysis_questions"
      message: "ã€ã‚¨ãƒªã‚¢åˆ†æã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã™ã‚‹å ´åˆã¯ã€Œæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ã‚¨ãƒªã‚¢åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_area_analysis_{{area_name}}.md"
      template_reference: "real_estate/insight_analysis.mdc => area_analysis_template"
      message: "ã‚¨ãƒªã‚¢åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚"
    - name: "notify_completion"
      action: "notify"
      message: |
        ã‚¨ãƒªã‚¢åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_area_analysis_{{area_name}}.md
        
        {{#use_existing_data}}
        æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã€Œ{{existing_data_path}}ã€ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{/use_existing_data}}
        {{^use_existing_data}}
        ãƒ¬ãƒãƒ¼ãƒˆå†…ã®å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ±äº¬ã‚¢ã‚»ãƒƒãƒˆAIã‚·ã‚¹ãƒ†ãƒ ã§ãƒ‡ãƒ¼ã‚¿åé›†ã¨åˆ†æã‚’è¡Œã„ã€
        ãƒ¬ãƒãƒ¼ãƒˆã‚’å……å®Ÿã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
        {{/use_existing_data}}
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æ
#--------------------------------------------
- trigger: "(ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æ|area forecast)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/insight_analysis.mdc => area_forecast_questions"
      message: "ã€ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã™ã‚‹å ´åˆã¯ã€Œæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_area_forecast_{{area_name}}.md"
      template_reference: "real_estate/insight_analysis.mdc => area_forecast_template"
      message: "ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚"
    - name: "notify_completion"
      action: "notify"
      message: |
        ã‚¨ãƒªã‚¢äºˆæ¸¬åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_area_forecast_{{area_name}}.md
        
        {{#use_existing_data}}
        æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã€Œ{{existing_data_path}}ã€ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{/use_existing_data}}
        {{^use_existing_data}}
        ãƒ¬ãƒãƒ¼ãƒˆå†…ã®å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ±äº¬ã‚¢ã‚»ãƒƒãƒˆAIã‚·ã‚¹ãƒ†ãƒ ã§ãƒ‡ãƒ¼ã‚¿åé›†ã¨åˆ†æã‚’è¡Œã„ã€
        å°†æ¥äºˆæ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’å……å®Ÿã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
        {{/use_existing_data}}
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æ
#--------------------------------------------
- trigger: "(é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æ|similar area analysis)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/insight_analysis.mdc => similar_area_questions"
      message: "ã€é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã™ã‚‹å ´åˆã¯ã€Œæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_similar_area_{{area_name}}.md"
      template_reference: "real_estate/insight_analysis.mdc => similar_area_template"
      message: "é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚"
    - name: "notify_completion"
      action: "notify"
      message: |
        é¡ä¼¼ã‚¨ãƒªã‚¢åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_similar_area_{{area_name}}.md
        
        {{#use_existing_data}}
        æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã€Œ{{existing_data_path}}ã€ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{/use_existing_data}}
        {{^use_existing_data}}
        ãƒ¬ãƒãƒ¼ãƒˆå†…ã®å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ±äº¬ã‚¢ã‚»ãƒƒãƒˆAIã‚·ã‚¹ãƒ†ãƒ ã§ãƒ‡ãƒ¼ã‚¿åé›†ã¨åˆ†æã‚’è¡Œã„ã€
        é¡ä¼¼ã‚¨ãƒªã‚¢ã®æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ã‚’å……å®Ÿã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
        {{/use_existing_data}}
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# æ±äº¬ã‚¢ã‚»ãƒƒãƒˆ: ã‚«ã‚¹ã‚¿ãƒ åˆ†æ
#--------------------------------------------
- trigger: "(ã‚«ã‚¹ã‚¿ãƒ åˆ†æ|custom analysis)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/insight_analysis.mdc => custom_analysis_questions"
      message: "ã€ã‚«ã‚¹ã‚¿ãƒ åˆ†æã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã™ã‚‹å ´åˆã¯ã€Œæ—¢å­˜ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ã€ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ã‚«ã‚¹ã‚¿ãƒ åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_custom_analysis_{{analysis_title | slugify}}.md"
      template_reference: "real_estate/insight_analysis.mdc => custom_analysis_template"
      message: "ã‚«ã‚¹ã‚¿ãƒ åˆ†æãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚"
    - name: "notify_completion"
      action: "notify"
      message: |
        ã‚«ã‚¹ã‚¿ãƒ åˆ†æãƒ¬ãƒãƒ¼ãƒˆã€Œ{{analysis_title}}ã€ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_custom_analysis_{{analysis_title | slugify}}.md
        
        {{#use_existing_data}}
        æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã€Œ{{existing_data_path}}ã€ã‚’ä½¿ç”¨ã—ã¦ãƒ¬ãƒãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚
        {{/use_existing_data}}
        {{^use_existing_data}}
        ãƒ¬ãƒãƒ¼ãƒˆå†…ã®å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ±äº¬ã‚¢ã‚»ãƒƒãƒˆAIã‚·ã‚¹ãƒ†ãƒ ã§ãƒ‡ãƒ¼ã‚¿åé›†ã¨åˆ†æã‚’è¡Œã„ã€
        ã‚«ã‚¹ã‚¿ãƒ åˆ†æã‚’å……å®Ÿã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
        {{/use_existing_data}}
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Research ãƒ•ã‚§ãƒ¼ã‚º
#--------------------------------------------
- trigger: "(ãƒªã‚µãƒ¼ãƒ|Research)"
  priority: high
  steps:
    - message: |
        Researchï¼ˆãƒªã‚µãƒ¼ãƒï¼‰ãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ä»¥ä¸‹ã®æˆæœç‰©ã‚’ä½œæˆã§ãã¾ã™ï¼š
        - **é¡§å®¢èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ**ï¼šã€Œé¡§å®¢èª¿æŸ»ã€ã¨å…¥åŠ›
        - **ç«¶åˆèª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ**ï¼šã€Œç«¶åˆèª¿æŸ»ã€ã¨å…¥åŠ›
        - **ç·åˆãƒ‡ã‚¹ã‚¯ãƒªã‚µãƒ¼ãƒ**ï¼šã€Œãƒ‡ã‚¹ã‚¯ãƒªã‚µãƒ¼ãƒã€ã¨å…¥åŠ›

#--------------------------------------------
# Research: é¡§å®¢èª¿æŸ»
#--------------------------------------------
- trigger: "(é¡§å®¢èª¿æŸ»|Customer Research)"
  priority: high
  steps:
    - name: "collect_research_requirements"
      action: "ask_questions"
      questions:
        - key: "project_name"
          question: "èª¿æŸ»å¯¾è±¡ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: true
        - key: "target_audience"
          question: "èª¿æŸ»ã—ãŸã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚ªãƒ¼ãƒ‡ã‚£ã‚¨ãƒ³ã‚¹ã‚’å…·ä½“çš„ã«æ•™ãˆã¦ãã ã•ã„"
          required: true
        - key: "research_topics"
          question: "é¡§å®¢èª¿æŸ»ã§ç‰¹ã«çŸ¥ã‚ŠãŸã„å†…å®¹ã‚„ãƒˆãƒ”ãƒƒã‚¯ã‚’æ•™ãˆã¦ãã ã•ã„ï¼ˆè¤‡æ•°å¯ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰"
          required: true
        - key: "industry_context"
          question: "æ¥­ç•Œã‚„å¸‚å ´ã®èƒŒæ™¯æƒ…å ±ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„"
          required: false
      store_as: "research_params"
    - name: "confirm_research"
      action: "confirm"
      message: "ä»¥ä¸‹ã®å†…å®¹ã§é¡§å®¢èª¿æŸ»ã‚’å®Ÿæ–½ã—ã¾ã™ï¼š\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: {{research_params.project_name}}\nã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: {{research_params.target_audience}}\nèª¿æŸ»ãƒˆãƒ”ãƒƒã‚¯: {{research_params.research_topics}}\n\nWebæ¤œç´¢ã‚’é–‹å§‹ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "web_research_audience"
      action: "web_search"
      search_term: "{{research_params.target_audience}} é¡§å®¢ç‰¹æ€§ æ¶ˆè²»è€…è¡Œå‹• ãƒ‹ãƒ¼ã‚º æœ€æ–°å‹•å‘"
      explanation: "ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚ªãƒ¼ãƒ‡ã‚£ã‚¨ãƒ³ã‚¹ã«ã¤ã„ã¦ã®æœ€æ–°æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "audience_data"
    - name: "web_research_topics"
      action: "web_search"
      search_term: "{{research_params.target_audience}} {{research_params.research_topics}} æ¶ˆè²»è€…èª¿æŸ» å¸‚å ´èª¿æŸ» æœ€æ–°"
      explanation: "æŒ‡å®šã•ã‚ŒãŸãƒˆãƒ”ãƒƒã‚¯ã«é–¢ã™ã‚‹é¡§å®¢èª¿æŸ»æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "topic_data"
    - name: "web_research_behavior"
      action: "web_search"
      search_term: "{{research_params.target_audience}} è³¼è²·è¡Œå‹• æ„æ€æ±ºå®šãƒ—ãƒ­ã‚»ã‚¹ é¡§å®¢ä½“é¨“ {{research_params.industry_context}}"
      explanation: "ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®è³¼è²·è¡Œå‹•ã‚„æ„æ€æ±ºå®šãƒ—ãƒ­ã‚»ã‚¹ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "behavior_data"
    - name: "analyze_web_research"
      action: "analyze"
      data: ["{{audience_data}}", "{{topic_data}}", "{{behavior_data}}"]
      instructions: "åé›†ã—ãŸWebæ¤œç´¢ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ä¸»è¦ãªæ´å¯Ÿã€å‚¾å‘ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ½å‡ºã—ã¾ã™"
      store_as: "analyzed_results"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_date}}/draft_customer_research.md"
      template_reference: "basic/03_pmbok_research.mdc => customer_research_template"
      data_mapping:
        project_name: "{{research_params.project_name}}"
        target_audience: "{{research_params.target_audience}}"
        research_period: "{{today}}"
        research_method: "Webæ¤œç´¢ã«ã‚ˆã‚‹äºŒæ¬¡èª¿æŸ»"
        research_themes: "{{research_params.research_topics | split: ','}}"
        customer_insights: "{{analyzed_results.insights}}"
        customer_behavior: "{{analyzed_results.behavior}}"
        customer_needs: "{{analyzed_results.needs}}"
        customer_segments: "{{analyzed_results.segments}}"
    - name: "notify_completion"
      action: "notify"
      message: |
        é¡§å®¢èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_date}}/draft_customer_research.md
        
        Webæ¤œç´¢çµæœã‚’ã‚‚ã¨ã«ä¸»è¦ãªé¡§å®¢ã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚
        å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ç·¨é›†å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Research: ç«¶åˆèª¿æŸ»
#--------------------------------------------
- trigger: "(ç«¶åˆèª¿æŸ»|Competitor Research)"
  priority: high
  steps:
    - name: "collect_research_requirements"
      action: "ask_questions"
      questions:
        - key: "project_name"
          question: "èª¿æŸ»å¯¾è±¡ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: true
        - key: "product_service"
          question: "è‡ªç¤¾ã®è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®æ¦‚è¦ã‚’ç°¡æ½”ã«æ•™ãˆã¦ãã ã•ã„"
          required: true
        - key: "main_competitors"
          question: "ä¸»ãªç«¶åˆä¼æ¥­ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°å¯ï¼‰"
          required: false
        - key: "research_focus"
          question: "ç«¶åˆèª¿æŸ»ã§ç‰¹ã«çŸ¥ã‚ŠãŸã„å´é¢ã‚’æ•™ãˆã¦ãã ã•ã„ï¼ˆä¾‹ï¼šä¾¡æ ¼æˆ¦ç•¥ã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æ‰‹æ³•ã€è£½å“æ©Ÿèƒ½ãªã©ï¼‰"
          required: true
      store_as: "research_params"
    - name: "confirm_research"
      action: "confirm"
      message: "ä»¥ä¸‹ã®å†…å®¹ã§ç«¶åˆèª¿æŸ»ã‚’å®Ÿæ–½ã—ã¾ã™ï¼š\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: {{research_params.project_name}}\nè‡ªç¤¾è£½å“/ã‚µãƒ¼ãƒ“ã‚¹: {{research_params.product_service}}\nä¸»ãªç«¶åˆ: {{research_params.main_competitors}}\nèª¿æŸ»ãƒ•ã‚©ãƒ¼ã‚«ã‚¹: {{research_params.research_focus}}\n\nWebæ¤œç´¢ã‚’é–‹å§‹ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "web_research_competitors"
      action: "web_search"
      search_term: "{{research_params.product_service}} æ¥­ç•Œ ä¸»è¦ä¼æ¥­ ç«¶åˆ ãƒãƒ¼ã‚±ãƒƒãƒˆã‚·ã‚§ã‚¢ æœ€æ–°"
      explanation: "æ¥­ç•Œã®ä¸»è¦ç«¶åˆä¼æ¥­ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "competitors_data"
    - name: "web_research_specific_competitors"
      action: "web_search"
      search_term: "{{research_params.main_competitors}} {{research_params.research_focus}} æˆ¦ç•¥ ç‰¹å¾´ æœ€æ–°å‹•å‘"
      condition: "research_params.main_competitors"
      explanation: "æŒ‡å®šã•ã‚ŒãŸç«¶åˆä¼æ¥­ã«ã¤ã„ã¦ã®è©³ç´°æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "specific_competitors_data"
    - name: "web_research_market_trends"
      action: "web_search"
      search_term: "{{research_params.product_service}} å¸‚å ´å‹•å‘ æ¥­ç•Œãƒˆãƒ¬ãƒ³ãƒ‰ æœ€æ–°æŠ€è¡“ å°†æ¥äºˆæ¸¬"
      explanation: "æ¥­ç•Œã®å¸‚å ´å‹•å‘ã¨æœ€æ–°ãƒˆãƒ¬ãƒ³ãƒ‰ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "market_trends_data"
    - name: "web_research_competitive_strategies"
      action: "web_search"
      search_term: "{{research_params.product_service}} æ¥­ç•Œ {{research_params.research_focus}} ç«¶äº‰æˆ¦ç•¥ å·®åˆ¥åŒ–è¦å› "
      explanation: "ç«¶åˆã®æˆ¦ç•¥ã¨å·®åˆ¥åŒ–è¦å› ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "strategies_data"
    - name: "analyze_web_research"
      action: "analyze"
      data: ["{{competitors_data}}", "{{specific_competitors_data}}", "{{market_trends_data}}", "{{strategies_data}}"]
      instructions: "åé›†ã—ãŸWebæ¤œç´¢ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ç«¶åˆä¼æ¥­ã®ä¸»è¦ç‰¹æ€§ã€å¸‚å ´ãƒã‚¸ã‚·ãƒ§ãƒ³ã€æˆ¦ç•¥ã€å¼·ã¿ãƒ»å¼±ã¿ã‚’æŠ½å‡ºã—ã¾ã™"
      store_as: "analyzed_results"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_date}}/draft_competitor_research.md"
      template_reference: "basic/03_pmbok_research.mdc => competitor_research_template"
      data_mapping:
        project_name: "{{research_params.project_name}}"
        product_service: "{{research_params.product_service}}"
        research_period: "{{today}}"
        research_method: "Webæ¤œç´¢ã«ã‚ˆã‚‹äºŒæ¬¡èª¿æŸ»"
        research_themes: "{{research_params.research_focus | split: ','}}"
        competitor_overview: "{{analyzed_results.overview}}"
        competitor_strategies: "{{analyzed_results.strategies}}"
        market_position: "{{analyzed_results.market_position}}"
        swot_analysis: "{{analyzed_results.swot}}"
    - name: "notify_completion"
      action: "notify"
      message: |
        ç«¶åˆèª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_date}}/draft_competitor_research.md
        
        Webæ¤œç´¢çµæœã‚’ã‚‚ã¨ã«ä¸»è¦ãªç«¶åˆæƒ…å ±ã¨å¸‚å ´å‹•å‘ã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚
        å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ç·¨é›†å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Research: ç·åˆãƒ‡ã‚¹ã‚¯ãƒªã‚µãƒ¼ãƒ
#--------------------------------------------
- trigger: "(ãƒ‡ã‚¹ã‚¯ãƒªã‚µãƒ¼ãƒ|Desk Research)"
  priority: high
  steps:
    - name: "collect_research_requirements"
      action: "ask_questions"
      questions:
        - key: "project_name"
          question: "èª¿æŸ»å¯¾è±¡ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: true
        - key: "research_scope"
          question: "èª¿æŸ»ã®ç¯„å›²ã‚’é¸æŠã—ã¦ãã ã•ã„"
          options:
            - "å¸‚å ´ãƒ»æ¥­ç•Œå‹•å‘"
            - "é¡§å®¢å‹•å‘"
            - "ç«¶åˆåˆ†æ"
            - "æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰"
            - "è¦åˆ¶ãƒ»æ³•å¾‹å‹•å‘"
            - "ãã®ä»–"
          multi_select: true
          required: true
        - key: "specific_topics"
          question: "å…·ä½“çš„ã«èª¿æŸ»ã—ãŸã„å†…å®¹ã‚„ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: true
        - key: "industry_context"
          question: "æ¥­ç•Œã‚„å¯¾è±¡å¸‚å ´ã®èƒŒæ™¯æƒ…å ±ãŒã‚ã‚Œã°å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: false
      store_as: "research_params"
    - name: "confirm_research"
      action: "confirm"
      message: "ä»¥ä¸‹ã®å†…å®¹ã§ãƒ‡ã‚¹ã‚¯ãƒªã‚µãƒ¼ãƒã‚’å®Ÿæ–½ã—ã¾ã™ï¼š\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: {{research_params.project_name}}\nèª¿æŸ»ç¯„å›²: {{research_params.research_scope}}\nèª¿æŸ»ãƒˆãƒ”ãƒƒã‚¯: {{research_params.specific_topics}}\n\nWebæ¤œç´¢ã‚’é–‹å§‹ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "web_research_market_industry"
      action: "web_search"
      search_term: "{{research_params.specific_topics}} {{research_params.industry_context}} å¸‚å ´è¦æ¨¡ æ¥­ç•Œå‹•å‘ æœ€æ–°ãƒ‡ãƒ¼ã‚¿"
      explanation: "å¸‚å ´ãƒ»æ¥­ç•Œå‹•å‘ã«é–¢ã™ã‚‹æœ€æ–°æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      condition: "research_params.research_scope.includes('å¸‚å ´ãƒ»æ¥­ç•Œå‹•å‘')"
      store_as: "market_data"
    - name: "web_research_customer"
      action: "web_search"
      search_term: "{{research_params.specific_topics}} é¡§å®¢å‹•å‘ æ¶ˆè²»è€…ãƒˆãƒ¬ãƒ³ãƒ‰ è³¼è²·è¡Œå‹• {{research_params.industry_context}}"
      explanation: "é¡§å®¢å‹•å‘ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      condition: "research_params.research_scope.includes('é¡§å®¢å‹•å‘')"
      store_as: "customer_data"
    - name: "web_research_competitors"
      action: "web_search"
      search_term: "{{research_params.specific_topics}} ç«¶åˆåˆ†æ ä¸»è¦ä¼æ¥­ æ¯”è¼ƒ {{research_params.industry_context}}"
      explanation: "ç«¶åˆåˆ†æã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      condition: "research_params.research_scope.includes('ç«¶åˆåˆ†æ')"
      store_as: "competitors_data"
    - name: "web_research_technology"
      action: "web_search"
      search_term: "{{research_params.specific_topics}} æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰ æœ€æ–°æŠ€è¡“ ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ {{research_params.industry_context}}"
      explanation: "æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      condition: "research_params.research_scope.includes('æŠ€è¡“ãƒˆãƒ¬ãƒ³ãƒ‰')"
      store_as: "technology_data"
    - name: "web_research_regulation"
      action: "web_search"
      search_term: "{{research_params.specific_topics}} è¦åˆ¶ æ³•å¾‹ ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ æœ€æ–° {{research_params.industry_context}}"
      explanation: "è¦åˆ¶ãƒ»æ³•å¾‹å‹•å‘ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      condition: "research_params.research_scope.includes('è¦åˆ¶ãƒ»æ³•å¾‹å‹•å‘')"
      store_as: "regulation_data"
    - name: "web_research_other"
      action: "web_search"
      search_term: "{{research_params.specific_topics}} {{research_params.industry_context}} æœ€æ–°"
      explanation: "ãã®ä»–ã®ç‰¹å®šãƒˆãƒ”ãƒƒã‚¯ã«é–¢ã™ã‚‹æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      condition: "research_params.research_scope.includes('ãã®ä»–')"
      store_as: "other_data"
    - name: "analyze_web_research"
      action: "analyze"
      data: ["{{market_data}}", "{{customer_data}}", "{{competitors_data}}", "{{technology_data}}", "{{regulation_data}}", "{{other_data}}"]
      instructions: "åé›†ã—ãŸWebæ¤œç´¢ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ä¸»è¦ãªæ´å¯Ÿã€ãƒˆãƒ¬ãƒ³ãƒ‰ã€çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã™"
      store_as: "analyzed_results"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_date}}/draft_desk_research.md"
      template_reference: "basic/03_pmbok_research.mdc => desk_research_template"
      data_mapping:
        project_name: "{{research_params.project_name}}"
        research_period: "{{today}}"
        research_method: "Webæ¤œç´¢ã«ã‚ˆã‚‹äºŒæ¬¡èª¿æŸ»"
        research_scope: "{{research_params.research_scope | join: ', '}}"
        specific_topics: "{{research_params.specific_topics}}"
        market_overview: "{{analyzed_results.market_overview}}"
        customer_insights: "{{analyzed_results.customer_insights}}"
        competitor_analysis: "{{analyzed_results.competitor_analysis}}"
        technology_trends: "{{analyzed_results.technology_trends}}"
        regulatory_environment: "{{analyzed_results.regulatory_environment}}"
        key_findings: "{{analyzed_results.key_findings}}"
    - name: "notify_completion"
      action: "notify"
      message: |
        ãƒ‡ã‚¹ã‚¯ãƒªã‚µãƒ¼ãƒãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_date}}/draft_desk_research.md
        
        Webæ¤œç´¢çµæœã‚’ã‚‚ã¨ã«å„ãƒˆãƒ”ãƒƒã‚¯ã®ä¸»è¦æƒ…å ±ã¨æ´å¯Ÿã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚
        å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ç·¨é›†å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Research: å¸‚å ´è¦æ¨¡æ¨å®š
#--------------------------------------------
- trigger: "(å¸‚å ´è¦æ¨¡æ¨å®š|TAM SAM SOM|ãƒ•ã‚§ãƒ«ãƒŸæ¨å®š|Market Size Estimation)"
  priority: high
  steps:
    - name: "collect_research_requirements"
      action: "ask_questions"
      questions:
        - key: "project_name"
          question: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ/è£½å“/ã‚µãƒ¼ãƒ“ã‚¹åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"
          required: true
        - key: "business_description"
          question: "ãƒ“ã‚¸ãƒã‚¹ãƒ¢ãƒ‡ãƒ«ã‚„è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®æ¦‚è¦ã‚’ç°¡æ½”ã«èª¬æ˜ã—ã¦ãã ã•ã„"
          required: true
        - key: "target_customers"
          question: "ä¸»è¦ãªã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¡§å®¢ã‚’å…·ä½“çš„ã«æ•™ãˆã¦ãã ã•ã„"
          required: true
        - key: "geographic_scope"
          question: "å¯¾è±¡åœ°åŸŸï¼ˆå›½å†…/å›½éš›/ç‰¹å®šåœ°åŸŸãªã©ï¼‰ã‚’æŒ‡å®šã—ã¦ãã ã•ã„"
          required: true
        - key: "estimation_approach"
          question: "å¸‚å ´è¦æ¨¡æ¨å®šã®ä¸»ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’é¸æŠã—ã¦ãã ã•ã„"
          options:
            - "ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼ˆå…¨ä½“å¸‚å ´ã‹ã‚‰çµã‚Šè¾¼ã‚€ï¼‰"
            - "ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ï¼ˆå€‹åˆ¥è¦ç´ ã‹ã‚‰ç©ã¿ä¸Šã’ã‚‹ï¼‰"
            - "ãƒãƒªãƒ¥ãƒ¼ãƒã‚§ãƒ¼ãƒ³åˆ†æ"
          default: "ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ï¼ˆå€‹åˆ¥è¦ç´ ã‹ã‚‰ç©ã¿ä¸Šã’ã‚‹ï¼‰"
          required: true
      store_as: "market_params"
    - name: "confirm_research"
      action: "confirm"
      message: "ä»¥ä¸‹ã®å†…å®¹ã§å¸‚å ´è¦æ¨¡æ¨å®šã‚’å®Ÿæ–½ã—ã¾ã™ï¼š\n\nãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: {{market_params.project_name}}\nã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¡§å®¢: {{market_params.target_customers}}\nå¯¾è±¡åœ°åŸŸ: {{market_params.geographic_scope}}\næ¨å®šã‚¢ãƒ—ãƒ­ãƒ¼ãƒ: {{market_params.estimation_approach}}\n\nWebæ¤œç´¢ã‚’é–‹å§‹ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "web_search_market_size"
      action: "web_search"
      search_term: "{{market_params.business_description}} {{market_params.target_customers}} å¸‚å ´è¦æ¨¡ TAM SAM SOM {{market_params.geographic_scope}}"
      explanation: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«é–¢é€£ã™ã‚‹å¸‚å ´è¦æ¨¡æƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "market_size_data"
    - name: "web_search_industry_data"
      action: "web_search"
      search_term: "{{market_params.business_description}} æ¥­ç•Œãƒ‡ãƒ¼ã‚¿ çµ±è¨ˆ å¹´é–“æˆé•·ç‡ å¸‚å ´äºˆæ¸¬ {{market_params.geographic_scope}}"
      explanation: "æ¥­ç•Œå…¨ä½“ã®ãƒ‡ãƒ¼ã‚¿ã¨çµ±è¨ˆæƒ…å ±ã‚’åé›†ã—ã¾ã™"
      store_as: "industry_data"
    - name: "web_search_customer_data"
      action: "web_search"
      search_term: "{{market_params.target_customers}} äººå£çµ±è¨ˆ æ¶ˆè²»è€…è¡Œå‹• è³¼è²·é »åº¦ å¹³å‡æ”¯å‡º {{market_params.geographic_scope}}"
      explanation: "ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé¡§å®¢ã«é–¢ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¾ã™"
      store_as: "customer_data"
    - name: "web_search_specific_metrics"
      action: "web_search"
      search_term: "{{market_params.business_description}} ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ ãƒ‡ãƒ¼ã‚¿ æŒ‡æ¨™ {{market_params.estimation_approach == 'ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼ˆå…¨ä½“å¸‚å ´ã‹ã‚‰çµã‚Šè¾¼ã‚€ï¼‰' ? 'å¸‚å ´ã‚·ã‚§ã‚¢ ç«¶åˆ' : 'å˜ä¾¡ åˆ©ç”¨ç‡ é »åº¦'}}"
      explanation: "é¸æŠã—ãŸæ¨å®šã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«åŸºã¥ãå…·ä½“çš„ãªæŒ‡æ¨™ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã—ã¾ã™"
      store_as: "metrics_data"
    - name: "analyze_web_research"
      action: "analyze"
      data: ["{{market_size_data}}", "{{industry_data}}", "{{customer_data}}", "{{metrics_data}}"]
      instructions: "åé›†ã—ãŸWebæ¤œç´¢ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€TAM/SAM/SOMã®æ¨å®šã«å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨æ•°å€¤ã‚’æŠ½å‡ºã—ã¾ã™ã€‚ã¾ãŸãƒ•ã‚§ãƒ«ãƒŸæ¨å®šã«ä½¿ç”¨ã§ãã‚‹è¦ç´ ã‚’æ•´ç†ã—ã¾ã™ã€‚"
      store_as: "analyzed_results"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_date}}/draft_market_size_estimation.md"
      template_reference: "03_pmbok_research.mdc => market_size_template"
      data_mapping:
        project_name: "{{market_params.project_name}}"
        business_description: "{{market_params.business_description}}"
        target_customers: "{{market_params.target_customers}}"
        geographic_scope: "{{market_params.geographic_scope}}"
        estimation_factors: "{{analyzed_results.estimation_factors}}"
        specific_data_points: "{{analyzed_results.specific_data_points}}"
        assumptions: "{{analyzed_results.assumptions}}"
        competitors_share: "{{analyzed_results.competitors_share}}"
    - name: "notify_completion"
      action: "notify"
      message: |
        å¸‚å ´è¦æ¨¡æ¨å®šãƒ¬ãƒãƒ¼ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_date}}/draft_market_size_estimation.md
        
        Webæ¤œç´¢çµæœã‚’ã‚‚ã¨ã«TAMã€SAMã€SOMã®å¸‚å ´è¦æ¨¡æ¨å®šã‚’ã¾ã¨ã‚ã¾ã—ãŸã€‚
        å†…å®¹ã‚’ç¢ºèªã—ã€å¿…è¦ã«å¿œã˜ã¦ç·¨é›†å¾Œã€ã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# 16. Ideationãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
#--------------------------------------------
- trigger: "(ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆç”Ÿæˆ|ä¸å‹•ç”£ä¼ç”»|Ideation)"
  priority: high
  steps:
    - message: |
        Ideationãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã¯ä»¥ä¸‹ã®æˆæœç‰©ã‚’ä½œæˆã§ãã¾ã™ï¼š
        - **ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆç”Ÿæˆ**ï¼šã€Œä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆç”Ÿæˆã€ã¨å…¥åŠ›
        - **ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æ**ï¼šã€Œã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æã€ã¨å…¥åŠ›
        - **ä¼ç”»ãƒªãƒ•ã‚¡ã‚¤ãƒ³**ï¼šã€Œä¼ç”»ãƒªãƒ•ã‚¡ã‚¤ãƒ³ã€ã¨å…¥åŠ›
        - **ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ç”Ÿæˆ**ï¼šã€Œãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ç”Ÿæˆã€ã¨å…¥åŠ›

#--------------------------------------------
# Ideation: ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆç”Ÿæˆ
#--------------------------------------------
- trigger: "(ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆç”Ÿæˆ)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/ideation_module.mdc => concept_questions"
      message: "ã€ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆç”Ÿæˆã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_concept_{{property_type}}_{{area_name}}.md"
      template_reference: "real_estate/ideation_module.mdc => concept_template"
    - name: "notify_completion"
      action: "notify"
      message: |
        ä¼ç”»ã‚³ãƒ³ã‚»ãƒ—ãƒˆã€Œ{{area_name}} {{property_type}}ã€ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_concept_{{property_type}}_{{area_name}}.md
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Ideation: ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æ
#--------------------------------------------
- trigger: "(ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æ)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/ideation_module.mdc => comparison_questions"
      message: "ã€ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_concept_comparison_{{area_name}}.md"
      template_reference: "real_estate/ideation_module.mdc => comparison_template"
    - name: "notify_completion"
      action: "notify"
      message: |
        ã‚³ãƒ³ã‚»ãƒ—ãƒˆæ¯”è¼ƒåˆ†æã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_concept_comparison_{{area_name}}.md
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Ideation: ä¼ç”»ãƒªãƒ•ã‚¡ã‚¤ãƒ³
#--------------------------------------------
- trigger: "(ä¼ç”»ãƒªãƒ•ã‚¡ã‚¤ãƒ³)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/ideation_module.mdc => refine_questions"
      message: "ã€ä¼ç”»ãƒªãƒ•ã‚¡ã‚¤ãƒ³ã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ãƒªãƒ•ã‚¡ã‚¤ãƒ³ç‰ˆã‚³ãƒ³ã‚»ãƒ—ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_concept_refined_{{concept_id}}.md"
      template_reference: "real_estate/ideation_module.mdc => refine_template"
    - name: "notify_completion"
      action: "notify"
      message: |
        ãƒªãƒ•ã‚¡ã‚¤ãƒ³ç‰ˆã‚³ãƒ³ã‚»ãƒ—ãƒˆã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_concept_refined_{{concept_id}}.md
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚

#--------------------------------------------
# Ideation: ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ç”Ÿæˆ
#--------------------------------------------
- trigger: "(ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ç”Ÿæˆ)"
  priority: high
  steps:
    - name: "start_info_collection"
      action: "call real_estate/ideation_module.mdc => presentation_questions"
      message: "ã€ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ç”Ÿæˆã€‘ã«å¿…è¦ãªæƒ…å ±ã‚’åé›†ã—ã¾ã™ã€‚ä»¥ä¸‹ã®è³ªå•ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚"
    - name: "wait_user_responses"
      action: "wait_for_all_answers"
      message: "å¿…è¦ãªå›ç­”ãŒæƒã†ã¾ã§å…ˆã«é€²ã¿ã¾ã›ã‚“ã€‚"
    - name: "confirm_document_creation"
      action: "confirm"
      message: "åé›†ã—ãŸæƒ…å ±ã§ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ"
    - name: "create_draft"
      action: "create_markdown_file"
      path: "{{patterns.flow_private_date}}/draft_presentation_{{concept_id}}.md"
      template_reference: "real_estate/ideation_module.mdc => presentation_template"
    - name: "notify_completion"
      action: "notify"
      message: |
        ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™ã®ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸï¼š
        {{patterns.flow_private_date}}/draft_presentation_{{concept_id}}.md
        
        ä¿®æ­£å¾Œã€Œç¢ºå®šåæ˜ ã—ã¦ã€ã¨å…¥åŠ›ã™ã‚‹ã¨Stockãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚


